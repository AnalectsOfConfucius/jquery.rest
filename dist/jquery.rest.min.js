/*! jQuery REST Client - v0.0.1 - 2013-01-18
* https://github.com/jpillora/jquery.rest
* Copyright (c) 2013 Jaime Pillora; Licensed MIT */
(function(){"use strict";var e,t,n,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};r=function(e){throw"ERROR: jquery.rest: "+e},i={create:"POST",read:"GET",update:"PUT","delete":"DELETE"},s=function(e){var t;t="",e*=2;while(--e)t+=" ";return t},e=function(){function e(e,t,n){var i;return e||r("name required"),t||r("type required"),n||r("parent required"),n[e]&&r("cannot add: '"+e+"' as it already exists"),t=t.toUpperCase(),i=function(){var e,n,r;return r=this.extractUrlData(t,arguments),n=r.url,e=r.data,this.client.ajax(t,n+custom,e)},i.isOperation=!0,i.type=t,i}return e}(),t=function(){function t(e,t){this.name=e,this.parent=t,this.name||r("name required"),this.parent||r("parent required"),this.parent[this.name]&&r("cannot add: '"+e+"' as it already exists"),this.parent instanceof n?(this.numParents=0,this.client=this.parent):(this.numParents=this.parent.numParents+1,this.client=this.parent.client),this.urlNoId=this.parent.url+(""+this.name+"/"),this.url=this.urlNoId+(":ID_"+this.numParents+"/"),$.each(i,$.proxy(this.add,this))}return t.prototype.add=function(n,r){return r?this[n]=new e(n,r,this):this[n]=new t(n,this),null},t.prototype.show=function(e){return e==null&&(e=0),this.name&&console.log(s(e)+this.name+": "+this.url),$.each(this,function(t,n){if(n.isOperation===!0)return console.log(s(e+1)+n.type+": "+t)}),$.each(this,function(n,r){if(n!=="parent"&&n!=="client"&&r instanceof t)return r.show(e+1)})},t.prototype.toString=function(){return this.name},t.prototype.extractUrlData=function(e,t){var n,i,s,o,u,a,f,l,c,h,p;u=[],i=null;for(l=0,h=t.length;l<h;l++)n=t[l],$.type(n)==="string"?u.push(n):$.isPlainObject(n)&&i===null?i=n:r("Invalid parameter: "+n+" ("+$.type(n)+"). Must be strings and one optional plain object.");a=u.length,e!=="create"&&a===this.numParents+1?f=this.url:e!=="update"&&e!=="delete"&&a===this.numParents?f=this.urlNoId:r("Invalid number of ID parameters provided ("+a+")");for(s=c=0,p=u.length;c<p;s=++c)o=u[s],f=f.replace(new RegExp("/:ID_"+s+"/"),"/"+o+"/");return{url:f,data:i}},t}(),n=function(e){function t(e){$.type(e)==="string"?this.url=e:$.isPlainObject(e)&&(this.opts=e,this.url=this.opts.url),this.url||(this.url=""),this.url||(this.url=""),this.opts||(this.opts={})}return u(t,e),t.prototype.ajax=function(e,t,n,i){var s;return i==null&&(i={}),e||r("type missing"),t||r("url missing"),this.opts.username&&this.opts.password&&(window.btoa||r("You need a polyfill for 'btoa' to use basic auth."),s=window.btoa(this.opts.username+":"+this.opts.password),i.Authorization="Basic "+s),n&&this.opts.stringifyData&&(window.JSON||r("You need a polyfill for 'JSON' to use stringify."),n=window.JSON.stringify(n)),$.ajax({url:t,type:e,headers:i,data:n,processData:!1,dataType:"json"})},t}(t),$.RestClient=n}).call(this);