/*! jQuery REST Client - v1.0.0 - 2013-01-17
* https://github.com/jpillora/jquery.rest
* Copyright (c) 2013 Jaime Pillora; Licensed MIT */
(function(){"use strict";var e,t,n,r;n=function(e){throw"ERROR: jquery.rest: "+e},r={create:"POST",read:"GET",update:"PUT","delete":"DELETE"},e=function(){function e(e,i){var s=this;this.name=e,this.parent=i,this.name||n("name required"),this.parent||n("parent required"),this.parent[this.name]&&n("cannot add: '"+e+"' as it already exists"),this.parent instanceof t?(this.numParents=0,this.client=this.parent):(this.numParents=this.parent.numParents+1,this.client=this.parent.client),this.urlNoId=this.parent.url+(""+this.name+"/"),this.url=this.urlNoId+(":ID_"+this.numParents+"/"),$.each(r,function(e,t){return s[e]=function(){var e,n,r;return r=this.extractUrlData(t,arguments),n=r.url,e=r.data,this.client.ajax(t,n,e)}})}return e.prototype.add=function(t){return this[t]=new e(t,this)},e.prototype.show=function(){return console.log(""+this.name+": "+this.url),$.each(this,function(t,n){if(t!=="parent"&&n instanceof e)return n.show()})},e.prototype.toString=function(){return this.name},e.prototype.extractUrlData=function(e,t){var r,i,s,o,u,a,f,l,c,h,p;u=[],i=null;for(l=0,h=t.length;l<h;l++)r=t[l],$.type(r)==="string"?u.push(r):$.isPlainObject(r)&&i===null?i=r:n("Invalid parameter: "+r+" ("+$.type(r)+"). Must be strings and one optional plain object.");a=u.length,e!=="POST"&&a===this.numParents+1?f=this.url:e!=="GET"&&e!=="POST"||a!==this.numParents?n("Invalid number of ID parameters provided ("+a+")"):f=this.urlNoId;for(s=c=0,p=u.length;c<p;s=++c)o=u[s],f=f.replace(new RegExp("/:ID_"+s+"/"),"/"+o+"/");return{url:f,data:i}},e}(),t=function(){function t(e){$.type(e)==="string"?this.url=e:$.isPlainObject(e)&&(this.opts=e,this.url=this.opts.url),this.url||(this.url="")}return t.prototype.add=function(t){return this[t]=new e(t,this)},t.prototype.remove=function(e){return delete this[e]},t.prototype.show=function(){return $.each(this,function(t,n){if(n instanceof e)return n.show()})},t.prototype.ajax=function(e,t,n,r){n==null&&(n={}),r==null&&(r={});if(!e)throw"type missing";if(!t)throw"url missing";if(this.username&&this.password){if(!window.btoa)throw"You need a polyfill for 'btoa' to use basic auth.";r.Authorize=window.btoa(this.username+":"+this.password)}return $.ajax({url:t,type:e,headers:r,data:n,dataType:"json"})},t}(),$.RestClient=t}).call(this);